<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evolution of categorical traits — rayDISC • corHMM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evolution of categorical traits — rayDISC"><meta property="og:description" content="Fits a model of evolution for categorical traits, allowing for multi-state characters, polymorphisms, missing data, and incompletely resolved trees"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corHMM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/corHMMv2.1-vignette.html">corHMM 2.1: Generalized hidden Markov models</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evolution of categorical traits</h1>
    
    <div class="hidden name"><code>rayDISC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a model of evolution for categorical traits, allowing for multi-state characters, polymorphisms, missing data, and incompletely resolved trees</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rayDISC</span><span class="op">(</span><span class="va">phy</span>,<span class="va">data</span>, ntraits<span class="op">=</span><span class="fl">1</span>, charnum<span class="op">=</span><span class="fl">1</span>, rate.mat<span class="op">=</span><span class="cn">NULL</span>, model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ER"</span>,<span class="st">"SYM"</span>,<span class="st">"ARD"</span><span class="op">)</span>,</span>
<span>node.states<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"joint"</span>, <span class="st">"marginal"</span>, <span class="st">"scaled"</span>, <span class="st">"none"</span><span class="op">)</span>, state.recon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subsequently"</span><span class="op">)</span>, </span>
<span>lewis.asc.bias<span class="op">=</span><span class="cn">FALSE</span>, p<span class="op">=</span><span class="cn">NULL</span>, root.p<span class="op">=</span><span class="st">"yang"</span>, ip<span class="op">=</span><span class="cn">NULL</span>, lb<span class="op">=</span><span class="fl">1e-9</span>, ub<span class="op">=</span><span class="fl">100</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>diagn<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>phy</dt>
<dd><p>a phylogenetic tree, in <code>ape</code> “phylo” format.</p></dd>

<dt>data</dt>
<dd><p>a data matrix containing species information (see Details).</p></dd>

<dt>ntraits</dt>
<dd><p>specifies the number of traits to included in the analysis.</p></dd>

<dt>charnum</dt>
<dd><p>specified the character to analyze.</p></dd>

<dt>rate.mat</dt>
<dd><p>a user-supplied rate matrix index of parameters to be optimized.</p></dd>

<dt>model</dt>
<dd><p>specifies the underlying model.</p></dd>

<dt>node.states</dt>
<dd><p>method used to calculate ancestral states at internal nodes.</p></dd>

<dt>state.recon</dt>
<dd><p>whether to reconstruct states jointly with the rates or subsequent to the rates being optimized.</p></dd>

<dt>lewis.asc.bias</dt>
<dd><p>a logical indicating whether the ascertainment bias correction of Lewis et al. 2001 should be used. The default is <code>FALSE</code>.</p></dd>

<dt>p</dt>
<dd><p>a vector of transition rates. Allows the user to calculate the likelihood given a specified set of parameter values to specified as fixed and calculate the likelihood.</p></dd>

<dt>root.p</dt>
<dd><p>a vector used to fix the probabilities at the root, but “yang” and “maddfitz” can also be supplied to use the method of Yang (2006) and FitzJohn et al (2009), respectively (see details).</p></dd>

<dt>ip</dt>
<dd><p>initial values used for the likelihood search. Can be a single value or a vector of unique values for each parameter. The default is <code>ip=1</code>.</p></dd>

<dt>lb</dt>
<dd><p>lower bound for the likelihood search. The default is <code>lb=0</code>.</p></dd>

<dt>ub</dt>
<dd><p>upper bound for the likelihood search. The default is <code>ub=100</code>.</p></dd>

<dt>verbose</dt>
<dd><p>a logical indicating whether progress should be printed to the screen.</p></dd>

<dt>diagn</dt>
<dd><p>logical indicating whether diagnostic tests should be performed. The default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>__THIS FUNCTION IS NO LONGER NECESSARY AS IT IS NOW ENTIRELY SUBSUMED WITHIN__ <code>corHMM</code> (see _Generalized corHMM_ vignette). But we still provide it for those that are more comfortable using it than exploring the new <code>corHMM</code> function. As before, <code>rayDISC</code> takes a tree and a trait file and estimates transition rates and ancestral states for binary or multistate characters. The first column of the trait file must contain the species labels to match to the tree, with the second, third, fourth, and so on, corresponding to the traits of interest. Use the <code>charnum</code> variable to select the trait for analysis. Also, the input phylogeny need not be bifurcating as the algorithm is implemented to handle multifucations. Polytomies are allowed by generalizing Felsenstein's (1981) pruning algorithm to be the product of the probability of observing the tip states of n descendant nodes, rather than two, as in the completely bifurcating case.</p>
<p>The user can fix the root state probabilities by supplying a vector to the <code>root.p</code>. If the user supplies the flag <code>root.p</code>=“yang”, then the estimated transition rates are used to set the weights at the root (see pg. 124 Yang 2006), whereas specifying <code>root.p</code>=“maddfitz” employs the same procedure described by Maddison et al. (2007) and FitzJohn et al. (2009). Note that the default <code>root.p=NULL</code> assumes equal weighting among all possible states.</p>
<p>Ambiguities (polymorphic taxa or taxa missing data) are assigned likelihoods following Felsenstein (2004, p. 255). Taxa with missing data are coded “?” with all states observed at a tip. Polymorphic taxa are coded with states separated by an “&amp;”. For example, if a trait has four states and taxonA is observed to be in state 1 and 3, the character would be coded as “1&amp;3”. corHMM then uses this information to assign a likelihood of 1.0 to both states. Missing data are treated as ambiguous for all states, thus all states for taxa missing data are assigned a likelihood of 1.0. For example, for a four-state character (i.e. DNA), a taxon missing data will have likelihoods of all four states equal to 1.0 [e.g. L(A)=1.0, L(C)=1.0, L(G)=1.0, L(T)=1.0].</p>
<p>In all ancestral state reconstruction implementations, the rates are first estimated, and subsequently, the MLE estimates of the rates are used to determine either the state probabilities (i.e., marginal or "scaled") or maximum likelihood states at nodes. This is the default -- i.e., the state.recon="subsequently" argument. However, for this function only, we also allow for both rates and states to be estimated jointly. This can be done with state.recon="estimate". We also allow for a hypothesis about states at all or even some nodes to help fixed, with the rates (and in some cases some of the states) being estimated. This is state.recon="given". For more information please see Vignette "Getting Likelihoods From Reconstructions".</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>rayDISC</code> returns an object of class <code>rayDISC</code>. This is a list with elements:</p>
<dl><dt>$loglik</dt>
<dd><p>the maximum negative log-likelihood.</p></dd>

<dt>$AIC</dt>
<dd><p>Akaike information criterion.</p></dd>

<dt>$AICc</dt>
<dd><p>Akaike information criterion corrected for sample size.</p></dd>

<dt>$ntraits</dt>
<dd><p>The number of traits specified.</p></dd>

<dt>$solution</dt>
<dd><p>a matrix containing the maximum likelihood estimates of the transition rates.</p></dd>

<dt>$solution.se</dt>
<dd><p>a matrix containing the approximate standard errors of the transition rates. The standard error is calculated as the square root of the diagonal of the inverse of the Hessian matrix.</p></dd>

<dt>$index.mat</dt>
<dd><p>The indices of the parameters being estimated are returned. The numbers correspond to the row in the <code>eigvect</code> and can useful for identifying the parameters that are causing the objective function to be at a saddlepoint.</p></dd>

<dt>$lewis.asc.bias</dt>
<dd><p>The setting describing whether or not the Lewis ascertainment bias correction was used.</p></dd>

<dt>$opts</dt>
<dd><p>Internal settings of the likelihood search.</p></dd>

<dt>$data</dt>
<dd><p>User-supplied dataset.</p></dd>

<dt>$phy</dt>
<dd><p>User-supplied tree.</p></dd>

<dt>$states</dt>
<dd><p>The likeliest states at each internal node.</p></dd>

<dt>$tip.states</dt>
<dd><p>NULL</p></dd>

<dt>$iterations</dt>
<dd><p>The number of iterations used by the optimization routine.</p></dd>

<dt>$eigval</dt>
<dd><p>The eigenvalues from the decomposition of the Hessian of the likelihood function. If any <code>eigval&lt;0</code> then one or more parameters were not optimized during the likelihood search.</p></dd>

<dt>$eigvect</dt>
<dd><p>The eigenvectors from the decomposition of the Hessian of the likelihood function is returned.</p></dd>

<dt>$bound.hit</dt>
<dd><p>A logical for diagnosing if rate parameters were constrained by <code>lb</code> or <code>ub</code> values during optimization.</p></dd>

<dt>$message.tree</dt>
<dd><p>A list of taxa which were listed in the data matrix, but were not present in the passed <code>phylo</code> object. These taxa will be excluded from the analysis. <code>message.tree</code> is null if all taxa in data are included in tree.</p></dd>

<dt>$message.data</dt>
<dd><p>A list of taxa which were present in the passed <code>phylo</code> object, but lacked data in the passed data matrix. These taxa will be coded as missing data (all states equally likely). <code>message.data</code> is null if all taxa in tree have entries in data matrix.</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotRECON.html">plotRECON</a></code></p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Felsenstein, J. 1981. A likelihood approach to character weighting and what it tells us about parsimony and compatibility. Biological Journal of the Linnean Society 16: 183-196.</p>
<p>Felsenstein J. 2004. Inferring phylogenies. Sunderland MA: Sinauer Associates.</p>
<p>FitzJohn, R.G., W.P. Maddison, and S.P. Otto. 2009. Estimating trait-dependent speciation and extinction rates from incompletely resolved phylogenies. Systematic Biology 58:595-611.</p>
<p>Lewis, P.O. 2001. A likelihood approach to estimating phylogeny from discrete morphological character data. Systematic Biology 50:913-925.</p>
<p>Maddison, W.P., P.E. Midford, and S.P. Otto. 2007. Estimating a binary characters effect on speciation and extinction. Systematic Biology 56:701-710.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jeffrey C. Oliver and Jeremy M. Beaulieu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">### Example 1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rayDISC.example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Perform ancestral state estimation, using an asymmetric model of evolution and marginal</span></span></span>
<span class="r-in"><span><span class="co">## reconstruction of ancestral states</span></span></span>
<span class="r-in"><span><span class="va">recon</span> <span class="op">&lt;-</span> <span class="fu">rayDISC</span><span class="op">(</span><span class="va">rayDISC.example</span><span class="op">$</span><span class="va">tree</span>,<span class="va">rayDISC.example</span><span class="op">$</span><span class="va">trait</span>,model<span class="op">=</span><span class="st">"ARD"</span>,</span></span>
<span class="r-in"><span>node.states<span class="op">=</span><span class="st">"marginal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State distribution in data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> States:	0	0&amp;1	1	1&amp;0	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts:	10	2	8	0	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Beginning thorough search... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Inferring ancestral states using marginal reconstruction. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot reconstructions on tree</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotRECON.html">plotRECON</a></span><span class="op">(</span><span class="va">rayDISC.example</span><span class="op">$</span><span class="va">tree</span>,<span class="va">recon</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rayDISC-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2</span></span></span>
<span class="r-in"><span><span class="co">## Perform ancestral state estimation on second character, using a single-rate model of</span></span></span>
<span class="r-in"><span><span class="co">## evolution, marginal reconstruction of ancestral states, and setting the lower bound for</span></span></span>
<span class="r-in"><span><span class="co">## parameter estimates to 0.01</span></span></span>
<span class="r-in"><span><span class="va">recon</span> <span class="op">&lt;-</span> <span class="fu">rayDISC</span><span class="op">(</span><span class="va">rayDISC.example</span><span class="op">$</span><span class="va">tree</span>,<span class="va">rayDISC.example</span><span class="op">$</span><span class="va">trait</span>,charnum<span class="op">=</span><span class="fl">2</span>,model<span class="op">=</span><span class="st">"ER"</span>,</span></span>
<span class="r-in"><span>node.states<span class="op">=</span><span class="st">"marginal"</span>,lb<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State distribution in data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> States:	0	1	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts:	10	10	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Beginning thorough search... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Inferring ancestral states using marginal reconstruction. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 3</span></span></span>
<span class="r-in"><span><span class="co">## Perform ancestral state estimation on third character, using a single-rate model of</span></span></span>
<span class="r-in"><span><span class="co">## evolution and joint reconstruction of ancestral states</span></span></span>
<span class="r-in"><span><span class="va">recon</span> <span class="op">&lt;-</span> <span class="fu">rayDISC</span><span class="op">(</span><span class="va">rayDISC.example</span><span class="op">$</span><span class="va">tree</span>,<span class="va">rayDISC.example</span><span class="op">$</span><span class="va">trait</span>,charnum<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>model<span class="op">=</span><span class="st">"ER"</span>,node.states<span class="op">=</span><span class="st">"joint"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State distribution in data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> States:	0	1	2	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counts:	14	3	3	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Beginning thorough search... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished. Inferring ancestral states using joint reconstruction. </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Beaulieu, Brian O’Meara, Jeffrey Oliver, James Boyko.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

